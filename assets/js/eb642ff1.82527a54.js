"use strict";(self.webpackChunkondsel=self.webpackChunkondsel||[]).push([[5414],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>d});var o=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},s=Object.keys(e);for(o=0;o<s.length;o++)a=s[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)a=s[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=o.createContext({}),c=function(e){var t=o.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},h="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),h=c(a),m=n,d=h["".concat(l,".").concat(m)]||h[m]||u[m]||s;return a?o.createElement(d,r(r({ref:t},p),{},{components:a})):o.createElement(d,r({ref:t},p))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,r=new Array(s);r[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[h]="string"==typeof e?e:n,r[1]=i;for(var c=2;c<s;c++)r[c]=a[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,a)}m.displayName="MDXCreateElement"},9180:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var o=a(7462),n=(a(7294),a(3905));const s={slug:"default-assembly-workbench-3",title:"Exploring the A2plus workbench",authors:[{name:"Brad Collette",title:"Ondsel Core Team",url:"https://github.com/sliptonic",image_url:"https://avatars.githubusercontent.com/u/538057?v=4"},{name:"Alexandre Prokoudine",title:"Contributing Writer",url:"https://github.com/prokoudine",image_url:"https://avatars.githubusercontent.com/u/57467?v=4"}],tags:["freecad","development","assembly","assembly2"],image:"./titlecard.png",draft:!1},r=void 0,i={permalink:"/blog/default-assembly-workbench-3",source:"@site/blog/2023-03-21/assembly-2+.md",title:"Exploring the A2plus workbench",description:"We\u2019ve already talked about the need for a default assembly workbench in FreeCAD and reviewed Assembly 2. Now let\u2019s get into the nitty-gritty of the A2plus workbench.",date:"2023-03-21T00:00:00.000Z",formattedDate:"March 21, 2023",tags:[{label:"freecad",permalink:"/blog/tags/freecad"},{label:"development",permalink:"/blog/tags/development"},{label:"assembly",permalink:"/blog/tags/assembly"},{label:"assembly2",permalink:"/blog/tags/assembly-2"}],readingTime:8.875,hasTruncateMarker:!1,authors:[{name:"Brad Collette",title:"Ondsel Core Team",url:"https://github.com/sliptonic",image_url:"https://avatars.githubusercontent.com/u/538057?v=4",imageURL:"https://avatars.githubusercontent.com/u/538057?v=4"},{name:"Alexandre Prokoudine",title:"Contributing Writer",url:"https://github.com/prokoudine",image_url:"https://avatars.githubusercontent.com/u/57467?v=4",imageURL:"https://avatars.githubusercontent.com/u/57467?v=4"}],frontMatter:{slug:"default-assembly-workbench-3",title:"Exploring the A2plus workbench",authors:[{name:"Brad Collette",title:"Ondsel Core Team",url:"https://github.com/sliptonic",image_url:"https://avatars.githubusercontent.com/u/538057?v=4",imageURL:"https://avatars.githubusercontent.com/u/538057?v=4"},{name:"Alexandre Prokoudine",title:"Contributing Writer",url:"https://github.com/prokoudine",image_url:"https://avatars.githubusercontent.com/u/57467?v=4",imageURL:"https://avatars.githubusercontent.com/u/57467?v=4"}],tags:["freecad","development","assembly","assembly2"],image:"./titlecard.png",draft:!1},prevItem:{title:"Exploring the Assembly 3 workbench",permalink:"/blog/default-assembly-workbench-4"},nextItem:{title:"Exploring the Assembly 2 workbench",permalink:"/blog/default-assembly-workbench-2"}},l={image:a(5210).Z,authorsImageUrls:[void 0,void 0]},c=[{value:"History",id:"history",level:2},{value:"Workflow and ease of use",id:"workflow-and-ease-of-use",level:2},{value:"Features",id:"features",level:2},{value:"Consistency",id:"consistency",level:2},{value:"Stability",id:"stability",level:2},{value:"Performance",id:"performance",level:2},{value:"Development",id:"development",level:2},{value:"Community",id:"community",level:2},{value:"Summary",id:"summary",level:2},{value:"Next up",id:"next-up",level:2}],p={toc:c};function h(e){let{components:t,...s}=e;return(0,n.kt)("wrapper",(0,o.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"We\u2019ve already talked about the need for a ",(0,n.kt)("a",{parentName:"p",href:"https://ondsel.com/blog/default-assembly-workbench-1"},"default assembly workbench")," in FreeCAD and ",(0,n.kt)("a",{parentName:"p",href:"https://ondsel.com/blog/default-assembly-workbench-2"},"reviewed Assembly 2"),". Now let\u2019s get into the nitty-gritty of the A2plus workbench."),(0,n.kt)("h2",{id:"history"},"History"),(0,n.kt)("p",null,"A FreeCAD user kbwbe started working on this project in 2018 following ",(0,n.kt)("a",{parentName:"p",href:"https://forum.freecad.org/viewtopic.php?style=1&t=29207"},"experiments")," with a new solver developed on top of the pre-existing Assembly 2 workbench:"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"I developed a small prototype of yet another solver. It is in a very early state now and is only capable of handling plane/circularedge/axis-constraints. But it can easily be extended. It consists only of one file, which is attached. The base concept is inspired by physics. ","[...]"," It is just a prototype and many things are still missing. But the idea seems to work. I am working with a refurbished assembly2-workbench. I like the base concepts of it very much and did some bigger projects with it. ")),(0,n.kt)("p",null,"Having received initial feedback, kbwbe created a ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/kbwbe/A2plus"},"public repository")," on GitHub and continued hacking on the new workbench publicly."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Commits History for the A2plus Workbench",src:a(9146).Z,width:"1758",height:"558"})),(0,n.kt)("p",null,"Despite an activity plunge during the pandemic, A2plus is still being actively developed and receives new features and bug fixes."),(0,n.kt)("h2",{id:"workflow-and-ease-of-use"},"Workflow and ease of use"),(0,n.kt)("p",null,"A2plus follows the same general idea as its predecessor: create parts as separate files, align them with constraints, solve. Just like Assembly 2, this workbench supports sub-assemblies.\nThere are some differences though. The one that stands out immediately is that, rather than creating one constraint object in the project tree, A2plus creates references to the same constraint in both involved parts."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"A2plus Constraints in the Project Tree",src:a(8287).Z,width:"2560",height:"1440"})),(0,n.kt)("p",null,"Another difference is that a part in A2plus is a special type of an object. So it\u2019s possible to create a new part from within the workbench and fill it with objects e.g. in the Part Design workbench. But the part will have to be manually converted to an A2plus part to become usable in the workbench. The caveat here is that even then such a part will not be added to the BOM: only the parts imported from external files will be displayed there. Overall, the top-down design approach is not favored by A2plus, as earlier ",(0,n.kt)("a",{parentName:"p",href:"https://forum.freecad.org/viewtopic.php?style=1&p=265666#p265666"},"noted by kbwbe")," in the FreeCAD forum:"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Leaving PartDesign bodies within the assembly is not the intended workflow. Best way is to import everything. Converting is also not the preferred way. Even all parametrics of the parts get lost.")),(0,n.kt)("p",null,"Unlike Assembly 2, the A2plus workbench can also load user-selected objects from another FreeCAD project. In this case, the workbench will reference the object from the file, so FreeCAD will pick any changes made to the original project when you click the Update button."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Importing Objects from a FreeCAD Project File",src:a(6295).Z,width:"1234",height:"829"})),(0,n.kt)("p",null,"In terms of general user experience, A2plus is a major improvement over Assembly 2. Here are some examples of user-visible changes:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"When features (points, planes etc.) of multiple parts are selected, the workbench automatically makes available only the constraints that can be used with these features. This removes a lot of guesswork for new users."),(0,n.kt)("li",{parentName:"ul"},"Imported parts can easily be opened for editing as separate documents. All edited parts then can be updated with a single click."),(0,n.kt)("li",{parentName:"ul"},"When cleaning up an assembly, it\u2019s possible to easily delete all constraints associated with a part.")),(0,n.kt)("h2",{id:"features"},"Features"),(0,n.kt)("p",null,"The workbench has a respectable set of constraints: Point-to-Point, Point-on-Line, Point-on-Plane, Sphere-to-Sphere, Circular-Edge, Axis-to-Axis, Axis-to-Plane, Axis-Plane-Normal, Angular Axis-to-Plane, Planes-Parallelism, Planes-Coincident, Angled-Planes, Center-of-Mass. This covers a variety of use cases."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Constraints Available in A2plus",src:a(679).Z,width:"1857",height:"1085"})),(0,n.kt)("p",null,"A2plus comes with an autosolver. The way it works, however, is somewhat unreliable. Case in point: select two planes, create a Plane-Coincident constraint, solve, accept. Then select the constraint and change its Offset parameter in the Combo View. The autosolver will not update the position of the object that has the first plane, you will have to click the Solve button for this change to take effect."),(0,n.kt)("p",null,"There\u2019s a number of convenience features specific to A2plus (as compared to Assembly 2) such as placing labels on parts in the viewport for easier navigation or making parts\u2019 fills transparent.\nThe behavior of A2plus is configurable. Settings are available in the Preferences dialog:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"A2plus Preferences",src:a(8060).Z,width:"1612",height:"1004"})),(0,n.kt)("p",null,"Some features of the original Assembly 2 workbench are unavailable. Notably, the animation of the assembly for collision analysis is missing."),(0,n.kt)("p",null,"The A2plus workbench has a good ",(0,n.kt)("a",{parentName:"p",href:"https://wiki.freecad.org/A2plus_Workbench"},"reference guide")," on FreeCAD\u2019s wiki but lacks official tutorials that explain the workflow. The community, however, stepped up and provided a sufficient number of YouTube tutorials on using A2plus for a variety of use cases: ",(0,n.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=tI4trcyFwvs"},"mechanical design"),", ",(0,n.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=rIv15hX6Isw"},"woodworking"),", etc."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Update 2023-03-26:")," There is at least ",(0,n.kt)("a",{parentName:"p",href:"https://forum.freecad.org/viewtopic.php?f=20&t=46024"},"one documented case")," where the precision of the A2plus solver was not sufficient to get the job done. The workbench developer ",(0,n.kt)("a",{parentName:"p",href:"https://forum.freecad.org/viewtopic.php?p=395617#p395617"},"explained")," this by having to find a compromise between speed (responsiveness of the WB) and accuracy due to limited calculation power available to a solver written in Python.",(0,n.kt)("sup",{parentName:"p",id:"fnref-1-c07931"},(0,n.kt)("a",{parentName:"sup",href:"#fn-1-c07931",className:"footnote-ref"},"1"))),(0,n.kt)("h2",{id:"consistency"},"Consistency"),(0,n.kt)("p",null,"A2plus does a few things differently from many other workbenches. The most user-visible difference is how constraint settings are displayed. When a new constraint is being added, FreeCAD displays a floating dialog:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Constraint Properties in A2plus",src:a(5407).Z,width:"1347",height:"539"})),(0,n.kt)("p",null,"Double-clicking the constraint in the project tree reopens this floating dialog. However, the very same information is displayed in the Combo View. So there\u2019s two competing approaches to editing settings of a constraint."),(0,n.kt)("p",null,"Similarly, the first button in the Constraint toolbar opens another floating window that duplicates the list of constraints that is already available in that toolbar. This is not a common (although fairly optional-to-use) UI solution for FreeCAD."),(0,n.kt)("p",null,"As already noted, some objects require a conversion to an A2plus part, like the basic 3D objects created in the Part workbench. At the same time, this assembly workbench has no problem working with parts created in e.g. SheetMetal WB."),(0,n.kt)("p",null,"One important caveat of A2plus is that it doesn\u2019t use the standard ",(0,n.kt)("a",{parentName:"p",href:"https://wiki.freecad.org/App_Link"},"App::Link")," machinery to reference objects in other documents. Parts added to the document this way cannot be used in an assembly. "),(0,n.kt)("p",null,"Some actions, like adding a part from an external file are not correctly added to the undo buffer so they cannot be reverted in the normal way."),(0,n.kt)("h2",{id:"stability"},"Stability"),(0,n.kt)("p",null,"As of publishing this overview, there are no reported crashers that aren\u2019t fixed. There haven\u2019t even been many before: the issue tracker only lists 3 bugs in A2plus that ever crashed FreeCAD, and git log likewise lists only a few fixes for crashes. However, we were able to crash the program by pressing Ctrl+Z to undo while moving a part under constraints."),(0,n.kt)("p",null,"The main developer typically responds to bug reports within the first few days. There\u2019s a small number of bug reports with mild severity from 2019 where either no detailed information was provided by the reporter, or the developer couldn\u2019t replicate the issue, or the report slipped through developer\u2019s fingers. The workbench occasionally exhibits inconsistent or glitchy behavior like failing to delete a conflicting constraint. Other than that, nothing particularly bad stands out."),(0,n.kt)("h2",{id:"performance"},"Performance"),(0,n.kt)("p",null,"Assemblies are inherently complex beasts. It takes a substantial amount of talent, time, and effort to make a fast solver \u2014 a combination that not every volunteer has at their disposal. We\u2019ve definitely seen complaints like ",(0,n.kt)("a",{parentName:"p",href:"https://www.hobby-machinist.com/threads/freecad-assembly-a2plus-v0-4-54b.97301/"},"this one")," about performance issues in the A2plus workbench even with fairly simple assemblies. However, in our limited testing, we were unable to come up with conclusive evidence for assemblies \u201cblowing up\u201d after changes. Simple assemblies (up to 40 parts) did not represent a major issue for A2plus. But there was noticeable rendering slowdown when moving parts under constraints."),(0,n.kt)("p",null,"At least one of the reasons for possible performance issues according to the main A2plus developer is the inefficient use of memory. This is how he ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/kbwbe/A2plus/issues/378#issuecomment-612878010"},"explains")," it and goes on to give very useful hints about ways a programmer could deal with Python limitations:"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},'Memory management using Python as a programming language is not that easy and some memory leaks cannot be completely avoided. Python is keeping a lot of internal lists, which are immortal and their memory is not given back to the system during the lifetime of the program. So it is not possible to delete no more used objects from memory directly, as it is possible with "C/C++". Every object, which is not used anymore, is deleted (or sometimes it is not for various reasons), from Python\'s garbage collector.\nThe code can only be optimized in order to reduce memory consumption. (using slots, avoiding string concatenation etc). I will have a look at this next time, where it is possible. But this is a bunch of work and will need a lot of time. And it will never be perfect.')),(0,n.kt)("h2",{id:"development"},"Development"),(0,n.kt)("p",null,"The main developer responds to proposed contributions rather fast: many PRs by drive-by contributors are merged within days of submission, sometimes on the same day. Just 1 out of 452 pull requests is sitting unapplied on GitHub."),(0,n.kt)("p",null,"In the fall of 2022, a new regular contributor joined the project. His activity now rivals that of kbwbe."),(0,n.kt)("p",null,"Unlike with the original Assembly 2 workbench that had zero releases, the main developer of A2plus regularly tagged releases until November 2022 (a total of 101 tags so far). Releases mostly represent one or two bug fixes."),(0,n.kt)("h2",{id:"community"},"Community"),(0,n.kt)("p",null,"A2plus has one of the longest dedicated threads in the forum. However, since 2021, the activity of discussions has noticeably decreased: just 16 messages in the main thread in 2021, and 12 messages in 2022. The reason for this is unclear but might indicate that the interest towards the workbench has been decreasing as users move to other options."),(0,n.kt)("h2",{id:"summary"},"Summary"),(0,n.kt)("p",null,"A2plus represents a major improvement over the original Assembly 2 workbench in terms of both workflow, features, and usability. It has more types of constraints, more convenience features, and better supports single-user workflows. It\u2019s also sufficiently stable and has two developers who actively merge patches from other contributors. At the same time, the workbench has some unconventional UX/UI solutions and is reportedly prone to performance issues that are not easily resolved."),(0,n.kt)("h2",{id:"next-up"},"Next up"),(0,n.kt)("p",null,"In the next installment, we\u2019ll take a close look at Assembly 3, a workbench that actively uses a solver from another free/libre CAD program, SolveSpace."),(0,n.kt)("details",null,(0,n.kt)("summary",null,"Note..."),(0,n.kt)("div",null,(0,n.kt)("div",null,"I\u2019m Brad Collette, longtime FreeCAD contributor and CTO of Ondsel, a new open core company built on top of FreeCAD. Ondsel helps you share useful aspects of your solid models without giving away your designs. We\u2019re working on improving collaboration and feature accessibility and integrating with your existing tools. You can read more about my vision for FreeCAD and Ondsel ",(0,n.kt)("a",{href:"https://opencoreventures.com/blog/2023-01-ondsel-freecad-launch/"},"here")),(0,n.kt)("br",null))),(0,n.kt)("div",{className:"footnotes"},(0,n.kt)("hr",{parentName:"div"}),(0,n.kt)("ol",{parentName:"div"},(0,n.kt)("li",{parentName:"ol",id:"fn-1-c07931"},"This issue was raised in community discussion",(0,n.kt)("a",{parentName:"li",href:"#fnref-1-c07931",className:"footnote-backref"},"\u21a9")))))}h.isMDXComponent=!0},679:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/freecad-a2plus-constraint-options-136c354eb13a807fb6c2c41bbbb20675.png"},8287:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/freecad-a2plus-constraints-in-project-tree-77a47f6284ea3000322cdf7feff1d058.png"},6295:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/freecad-a2plus-load-objects-from-fc-file-b0059d99f66a4072ebd2a1577442fcc7.png"},9146:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/freecad-a2plus-wb-commits-9185649cf50276951e2453253a69253b.png"},5407:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/freecad-a2plus-wb-constraint-settings-5e2a1276923b19a0cd25fbee770e8540.png"},8060:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/freecad-a2plus-wb-preferences-aabfacf6943b50156010c4255d5892e9.png"},5210:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/titlecard-8f0e6f3ebdfbb0b53e662e6008331c3c.png"}}]);